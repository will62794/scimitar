{
    "preds"  :  [
        "(currentTerm[VARI] > currentTerm[VARJ])",
        "(currentTerm[VARJ] > currentTerm[VARI])",
        "(currentTerm[VARI] >= currentTerm[VARJ])",
        "(currentTerm[VARJ] >= currentTerm[VARI])",
        "(currentTerm[VARI] <= currentTerm[VARJ])",
        "(currentTerm[VARJ] <= currentTerm[VARI])",
        "(currentTerm[VARI] = currentTerm[VARJ])",
        "(state[VARI] = Leader)",
        "(state[VARI] = Follower)",
        "(state[VARI] = Candidate)",
        "(state[VARJ] = Leader)",
        "(state[VARJ] = Follower)",
        "(state[VARJ] = Candidate)",
        "(state[VARI] = Leader /\\ VARI # VARJ)",
        "(state[VARI] = Candidate /\\ VARI # VARJ)",
        "(state[VARI] \\in {Leader,Candidate} /\\ VARJ \\in votesGranted[VARI])",
        "(state[VARI] \\in {Leader,Candidate} /\\ VARI # VARJ)",
        "(state[VARI] \\in {Leader,Candidate} /\\ state[VARJ] \\in {Leader,Candidate} /\\ VARI # VARJ)",
        "VARREQVRESI.mterm = VARREQVRESJ.mterm /\\ VARREQVRESI.msource = VARREQVRESJ.msource",
        "VARREQVRESI.mdest = VARREQVRESJ.mdest",
        "VARREQVRESI.mvoteGranted /\\ VARREQVRESI.mvoteGranted = VARREQVRESJ.mvoteGranted",
        "VARREQVRESI.mterm = currentTerm[VARI] /\\ VARREQVRESI.msource = VARJ /\\ VARREQVRESI.mdest # VARI /\\ VARREQVRESI.mvoteGranted",
        "VARREQVRESI.mterm = currentTerm[VARI] /\\ VARREQVRESI.msource = VARJ /\\ VARREQVRESI.mvoteGranted",
        "(state[VARI] \\in {Follower,Candidate} /\\ VARI # VARJ)",
        "(state[VARI] = Leader /\\ VARI # VARJ /\\ currentTerm[VARI] = currentTerm[VARJ])",
        "(state[VARI] = Candidate /\\ VARI # VARJ)",
        "(state[VARI] = Candidate /\\ VARI # VARJ /\\ currentTerm[VARI] = currentTerm[VARJ])",
        "(state[VARI] = Follower /\\ VARI # VARJ)",
        "(state[VARJ] \\in {Leader,Candidate} /\\ VARI # VARJ)",
        "votesGranted[VARI] = {}",
        "votesGranted[VARJ] = {}",
        "votesGranted[VARI] \\in Quorum",
        "votesGranted[VARJ] \\in Quorum",
        "VARI \\in votesGranted[VARI]",
        "VARJ \\in votesGranted[VARI]",
        "VARI \\in votesGranted[VARJ]",
        "VARJ \\in votesGranted[VARJ]",
        "VARK \\in votesGranted[VARI]",
        "VARK \\in votesGranted[VARJ]",
        "VARREQVRESI.mterm = currentTerm[VARI]",
        "VARREQVRESI.mterm = currentTerm[VARJ]",
        "VARREQVRESI.msource = VARI",
        "VARREQVRESI.msource = VARJ",
        "VARREQVRESI.mdest = VARI",
        "VARREQVRESI.mdest = VARJ",
        "VARREQVRESI.mvoteGranted",
        "VARREQVRESI.mterm = currentTerm[VARREQVRESI.mdest]",
        "VARREQVRESI.mterm = currentTerm[VARREQVRESI.msource]",
        "currentTerm[VARREQVRESI.msource] >= VARREQVRESI.mterm",
        "currentTerm[VARREQVRESI.mdest] >= VARREQVRESI.mterm",
        "VARREQVRESI.msource \\in votesGranted[VARREQVRESI.mdest]",
        "VARREQVRESI.msource \\in votesGranted[VARREQVRESI.msource]",
        "VARI \\in votesGranted[VARREQVRESI.mdest]",
        "VARI \\in votesGranted[VARREQVRESI.msource]",
        "VARJ \\in votesGranted[VARREQVRESI.mdest]",
        "votedFor[VARI] # Nil",
        "votedFor[VARJ] # Nil",
        "votedFor[VARI] = VARI",
        "votedFor[VARJ] = VARJ",
        "votedFor[VARI] = VARJ",
        "votedFor[VARJ] = VARI",
        "votedFor[VARI] # Nil /\\ VARI \\in votesGranted[votedFor[VARI]]",
        "votedFor[VARREQVRESI.msource] = VARREQVRESI.mdest",
        "(commitIndex[VARI] > 0)",
        "IsPrefix(VARMAEREQ.mlog, log[VARI])",
        "Len(log[VARI]) = Len(VARMAEREQ.mlog)",
        "log = [log EXCEPT ![VARI] = Append(log[VARI], currentTerm[VARI])]",
        "log = [log EXCEPT ![VARJ] = Append(log[VARJ], currentTerm[VARJ])]",
        "VARI \\in VARQ /\\ currentTerm = currentTerm",
        "VARJ \\in VARQ /\\ currentTerm = currentTerm",
        "VARREQVM.mterm = currentTerm[VARI]",
        "VARREQVM.mterm > currentTerm[VARI]",
        "LastTerm(VARREQVM.mlog) = currentTerm[VARI]",
        "LastTerm(VARREQVM.mlog) > currentTerm[VARI]",
        "LastTerm(VARREQVM.mlog) > currentTerm[VARJ]",
        "LastTerm(VARREQVM.mlog) > currentTerm[VARJ]",
        "VARREQVM.mterm = currentTerm[VARJ]",
        "VARREQVM.msource = VARI",
        "VARREQVM.mdest = VARI",
        "VARREQVM.msource = VARJ",
        "VARREQVM.mdest = VARJ",
        "\\E INDK \\in DOMAIN log[VARI] : log[VARI][INDK] < currentTerm[VARI]",
        "\\A INDK \\in DOMAIN log[VARI] : log[VARI][INDK] <= currentTerm[VARI]",
        "\\E INDK \\in DOMAIN log[VARI] : log[VARI][INDK] > currentTerm[VARI]",
        "\\E INDK \\in DOMAIN log[VARI] : log[VARI][INDK] > currentTerm[VARJ]",
        "\\E INDK \\in DOMAIN log[VARJ] : log[VARJ][INDK] = currentTerm[VARI]",
        "\\E INDK \\in DOMAIN log[VARJ] : ~\\E INDI \\in DOMAIN log[VARI] : (INDI = INDK /\\ log[VARI][INDK] = log[VARJ][INDK])",
        "currentTerm[VARREQVM.msource] = VARREQVM.mterm",
        "currentTerm[VARREQVM.msource] >= VARREQVM.mterm",
        "state[VARREQVM.msource] = Leader",
        "state[VARREQVM.msource] = Candidate",
        "state[VARREQVM.mdest] = Candidate",
        "state[VARREQVM.mdest] = Candidate",
        "votedFor[VARREQVM.msource] # Nil",
        "votedFor[VARREQVM.msource] = VARREQVM.msource",
        "votedFor[VARREQVM.msource] = VARREQVM.mdest",
        "commitIndex[VARI] > VARMAEREQ.mcommitIndex",
        "VARMAEREQ.mlog = <<>>",
        "VARMAEREQ.mlog # <<>> /\\ VARLOGINDI \\in DOMAIN log[VARI] /\\ log[VARI][VARLOGINDI] = LastTerm(VARMAEREQ.mlog)",
        "VARMAEREQ.mlog # <<>> /\\ LastTerm(VARMAEREQ.mlog) = currentTerm[VARI]",
        "VARMAEREQ.mlog # <<>> /\\ LastTerm(VARMAEREQ.mlog) > currentTerm[VARI]",
        "VARMAEREQ.mlog # <<>> /\\ LastTerm(VARMAEREQ.mlog) = currentTerm[VARMAEREQ.msource]",
        "VARMAEREQ.mlog # <<>> /\\ LastTerm(VARMAEREQ.mlog) > currentTerm[VARMAEREQ.msource]",
        "VARMAEREQ.mlog # <<>> /\\ LastTerm(VARMAEREQ.mlog) <= currentTerm[VARI]",
        "VARMAEREQ.mlog # <<>> /\\ LastTerm(VARMAEREQ.mlog) <= VARMAEREQ.mterm",
        "VARMAEREQ.mlog # <<>> /\\ LastTerm(VARMAEREQ.mlog) > VARMAEREQ.mterm",
        "VARMAEREQ.mlog # <<>> /\\ LastTerm(VARMAEREQ.mlog) = currentTerm[VARI] /\\ state[VARI] = Leader",
        "VARLOGINDI \\in DOMAIN log[VARI] /\\ log[VARI][VARLOGINDI] = currentTerm[VARI]",
        "VARLOGINDI \\in DOMAIN log[VARI] /\\ log[VARI][VARLOGINDI] < currentTerm[VARI]",
        "VARLOGINDI \\in DOMAIN log[VARI] /\\ log[VARI][VARLOGINDI] > currentTerm[VARI]",
        "VARLOGINDI \\in DOMAIN log[VARI] /\\ log[VARI][VARLOGINDI] = currentTerm[VARJ]",
        "Len(log[VARI]) >= commitIndex[VARI]",
        "Len(log[VARI]) >= commitIndex[VARJ]",
        "Len(log[VARJ]) >= commitIndex[VARJ]",
        "Len(log[VARI]) >= commitIndex[VARI] /\\ Len(log[VARJ]) >= commitIndex[VARI] /\\ commitIndex[VARI] > 0 /\\ log[VARI][commitIndex[VARI]] = log[VARJ][commitIndex[VARI]]",
        "VARLOGINDI \\in DOMAIN log[VARI]",
        "VARLOGINDI \\in DOMAIN log[VARJ]",
        "VARLOGINDI \\in DOMAIN log[VARI] /\\ VARLOGINDI \\in DOMAIN log[VARJ] /\\ log[VARI][VARLOGINDI] = log[VARJ][VARLOGINDI]",
        "VARLOGINDI \\in DOMAIN log[VARI] /\\ Agree(VARI, VARLOGINDI) \\in Quorum /\\ matchIndex = matchIndex",
        "VARLOGINDI \\in DOMAIN log[VARI] /\\ Agree(VARI, VARLOGINDI) = {} /\\ matchIndex = matchIndex",
        "AgreeIndexes(VARI) = {} /\\ matchIndex = matchIndex",
        "AgreeIndexes(VARI) # {} /\\ log[VARI][Max(AgreeIndexes(VARI))] = currentTerm[VARI] /\\ matchIndex = matchIndex",
        "AgreeIndexes(VARI) # {} /\\ commitIndex[VARI] > Max(AgreeIndexes(VARI)) /\\ matchIndex = matchIndex",
        "AgreeIndexes(VARI) # {} /\\ commitIndex[VARI] = Max(AgreeIndexes(VARI)) /\\ matchIndex = matchIndex",
        "Len(log[VARI]) >= matchIndex[VARI][VARJ]",
        "Len(log[VARI]) > matchIndex[VARI][VARJ]",
        "commitIndex[VARI] \\in DOMAIN log[VARI] /\\ commitIndex[VARI] \\in DOMAIN log[VARJ] /\\ log[VARJ][commitIndex[VARI]] = log[VARI][commitIndex[VARI]]",
        "Len(log[VARMAERES.msource]) >= VARMAERES.mmatchIndex",
        "Len(log[VARMAERES.mdest]) >= VARMAERES.mmatchIndex",
        "log[VARMAERES.msource][VARMAERES.mmatchIndex] = log[VARMAERES.mdest][VARMAERES.mmatchIndex]",
        "VARMAERES.mterm = currentTerm[VARMAERES.mdest]",
        "VARMAERES.mterm = currentTerm[VARMAERES.msource]",
        "VARMAERES.mterm > currentTerm[VARMAERES.msource]",
        "VARMAERES.mterm = currentTerm[VARI]",
        "matchIndex[VARI][VARJ] = VARMAERES.mmatchIndex"
    ],
    "seed_lemmas": [
        "~((state[VARI] = Candidate /\\ VARI # VARJ)) \\/ (~(votesGranted[VARI] \\in Quorum)) \\/ (~(\\E INDK \\in DOMAIN log[VARJ] : log[VARJ][INDK] = currentTerm[VARI]))",
        "~((state[VARI] = Candidate /\\ VARI # VARJ)) \\/ (~(\\E INDK \\in DOMAIN log[VARJ] : log[VARJ][INDK] = currentTerm[VARI])) \\/ (~(GrantedVoteSet(VARI) \\in Quorum /\\ votesGranted = votesGranted /\\ requestVoteResponseMsgs = requestVoteResponseMsgs))",
        "~((state[VARI] = Leader /\\ VARI # VARJ /\\ currentTerm[VARI] = currentTerm[VARJ])) \\/ (~((state[VARJ] = Leader)))",
        "(VARLOGINDI \\in DOMAIN log[VARI] /\\ log[VARI][VARLOGINDI] = currentTerm[VARI]) \\/ (~(VARMAEREQ.mentries # <<>> /\\ VARMAEREQ.mentries[1] = currentTerm[VARI] /\\ state[VARI] = Leader)) \\/ (~(VARLOGINDI = VARMAEREQ.mprevLogIndex + 1))",
        "H_LogEntryInTermImpliesSafeAtTerm /\\ currentTerm = currentTerm /\\ state = state /\\ log = log /\\ votedFor = votedFor",
        "H_LogEntryInTermImpliesSafeAtTermAppendEntries /\\ currentTerm = currentTerm /\\ state = state /\\ log = log /\\ votedFor = votedFor /\\ appendEntriesRequestMsgs = appendEntriesRequestMsgs",
        "H_QuorumsSafeAtTerms /\\ currentTerm = currentTerm /\\ state = state /\\ votedFor = votedFor",
        "\\A s,t \\in Server : ( /\\ s # t /\\ state[s] \\in {Leader,Candidate} /\\ state[t] \\in {Leader,Candidate} /\\ currentTerm[s] = currentTerm[t]) => votesGranted[s] \\cap votesGranted[t] = {}",
        "\\A s,t \\in Server : \\A m \\in requestVoteResponseMsgs :( /\\ state[s] \\in {Candidate,Leader} /\\ t \\in votesGranted[s]) => ~(/\\ m.mterm = currentTerm[s] /\\ m.msource = t /\\ m.mdest # s /\\ m.mvoteGranted)",
        "\\A mi,mj \\in requestVoteResponseMsgs : (/\\ mi.mterm = mj.mterm /\\ mi.msource = mj.msource /\\ mi.mvoteGranted /\\ mj.mvoteGranted) => mi.mdest = mj.mdest",
        "\\A m \\in requestVoteResponseMsgs : m.mtype = RequestVoteResponse =>  /\\ (m.mvoteGranted /\\ (currentTerm[m.msource] = m.mterm)) => votedFor[m.msource] = m.mdest",
        "~((state[VARI] = Candidate /\\ VARI # VARJ /\\ currentTerm[VARI] = currentTerm[VARJ])) \\/ (~((state[VARJ] = Leader))) \\/ (~(votesGranted[VARI] \\in Quorum))",
        "~((state[VARI] = Candidate /\\ VARI # VARJ)) \\/ (~(VARMAEREQ.mentries # <<>> /\\ VARMAEREQ.mentries[1] = currentTerm[VARI])) \\/ (~(votesGranted[VARI] \\in Quorum))",
        "~((state[VARI] = Candidate /\\ VARI # VARJ)) \\/ (~(GrantedVoteSet(VARI) \\in Quorum /\\ votesGranted = votesGranted /\\ requestVoteResponseMsgs = requestVoteResponseMsgs)) \\/ (~(VARMAEREQ.mentries # <<>> /\\ VARMAEREQ.mentries[1] = currentTerm[VARI]))"
    ],
    "older_preds" : [
        "VARMAEREQ.mcommitIndex > 0",
        "(LogOk(VARI, VARMAEREQ) /\\ log = log) \\/ (~(VARMAEREQ.mentries # <<>> /\\ VARMAEREQ.mentries[1] = currentTerm[VARI] /\\ state[VARI] = Leader))",
        "H_PrimaryHasEntriesItCreated /\\ log = log /\\ state = state /\\ currentTerm = currentTerm"

    ],
    "action_local_preds":{
        "ClientRequestAction": [
        ],
        "BecomeLeaderAction": [
            "\\A s,t \\in Server : ( /\\ s # t /\\ state[s] \\in {Leader,Candidate} /\\ state[t] \\in {Leader,Candidate} /\\ currentTerm[s] = currentTerm[t]) => votesGranted[s] \\cap votesGranted[t] = {}"
        ],
        "HandleRequestVoteResponseAction": [

        ],
        "HandleRequestVoteRequestAction": [
            "\\A s,t \\in Server :  (/\\ state[s] = Candidate /\\ t \\in votesGranted[s]) => /\\ currentTerm[t] >= currentTerm[s]",
            " \\A s,t \\in Server : (/\\ state[s] = Candidate /\\ t \\in votesGranted[s]) =>  /\\ currentTerm[t] = currentTerm[s] => votedFor[t] = s"
        ],
        "AcceptAppendEntriesRequestAppendAction": [
        ]
    },
    "action_local_preds_KNOWN":{
        "BecomeLeaderAction": [
            "\\A s,t \\in Server : (/\\ s # t /\\ state[s] = Candidate /\\ votesGranted[s] \\in Quorum /\\ currentTerm[s] = currentTerm[t]) => state[t] # Leader",
            "\\A s,t \\in Server : ( /\\ s # t /\\ state[s] \\in {Leader,Candidate} /\\ state[t] \\in {Leader,Candidate} /\\ currentTerm[s] = currentTerm[t]) => votesGranted[s] \\cap votesGranted[t] = {}"
        ],
        "HandleRequestVoteResponseAction": [
            "\\A s \\in Server : (state[s] = Leader) => votesGranted[s] \\in Quorum",
            "\\A s,t \\in Server : ( /\\ s # t /\\ state[s] \\in {Leader,Candidate} /\\ state[t] \\in {Leader,Candidate} /\\ currentTerm[s] = currentTerm[t]) => votesGranted[s] \\cap votesGranted[t] = {}",
            "\\A s,t \\in Server : \\A m \\in requestVoteResponseMsgs :( /\\ state[s] \\in {Candidate,Leader} /\\ t \\in votesGranted[s]) => ~(/\\ m.mterm = currentTerm[s] /\\ m.msource = t /\\ m.mdest # s /\\ m.mvoteGranted)",
            "\\A mi,mj \\in requestVoteResponseMsgs : (/\\ mi.mterm = mj.mterm /\\ mi.msource = mj.msource /\\ mi.mvoteGranted /\\ mj.mvoteGranted) => mi.mdest = mj.mdest",
            "\\A m \\in requestVoteResponseMsgs : m.mtype = RequestVoteResponse =>  /\\ (m.mvoteGranted /\\ (currentTerm[m.msource] = m.mterm)) => votedFor[m.msource] = m.mdest"
        ],
        "HandleRequestVoteRequestAction": [
            "\\A s \\in Server : state[s] \\in {Candidate,Leader} => (\\A t \\in votesGranted[s] : /\\ currentTerm[t] >= currentTerm[s])",
            "\\A s \\in Server : state[s] \\in {Candidate,Leader} =>  (\\A t \\in votesGranted[s] :  /\\ currentTerm[t] = currentTerm[s] => votedFor[t] = s )",
            "\\A s,t \\in Server :  (/\\ state[s] = Candidate /\\ t \\in votesGranted[s]) => /\\ currentTerm[t] >= currentTerm[s]",
            " \\A s,t \\in Server : (/\\ state[s] = Candidate /\\ t \\in votesGranted[s]) =>  /\\ currentTerm[t] = currentTerm[s] => votedFor[t] = s"
        ]
    },
    "preds_alt" : [],
    "safety"  :  "H_LogMatching",
    "constants"  : {
        "n1" : "n1",
        "n2" : "n2",
        "n3" : "n3",
        "n4" : "n4",
        "n5" : "n5",
        "Server" : [ "{n1,n2,n3}", "{n1,n2,n3,n4,n5}"],
        "Follower" : "Follower",
        "Candidate" : "Candidate",
        "Leader" : "Leader",
        "Nil" : "Nil",
        "RequestVoteRequest" : "RequestVoteRequest",
        "RequestVoteResponse" : "RequestVoteResponse",
        "AppendEntriesRequest" : "AppendEntriesRequest",
        "AppendEntriesResponse" : "AppendEntriesResponse",
        "MaxTerm" : ["3"],
        "MaxLogLen" : ["2"],
        "MaxMsgCount": ["1000"]
    },
    "large_instance_inv_check_index": 1,
    "cti_gen_instance_indexes": [0,1],
    "constraint"  :  "StateConstraint",
    "quant_inv": "\\A VARI \\in Server : \\A VARJ \\in Server : \\A VARK \\in Server : \\E VARQ \\in Quorum : \\A VARMAEREQ \\in appendEntriesRequestMsgs : \\A VARMAERES \\in appendEntriesResponseMsgs : \\A VARREQVM \\in requestVoteRequestMsgs : \\A VARREQVRESI \\in requestVoteResponseMsgs : \\A VARREQVRESJ \\in requestVoteResponseMsgs : \\A VARLOGINDI \\in LogIndices : ",
    "quant_vars": ["VARI", "VARJ", "VARK", "VARIND", "VARM", "VARLOGINDI"],
    "model_consts"  :  "CONSTANT n1,n2,n3,n4,n5",
    "simulation_inv_check": true,
    "simulation_inv_check_num_states": 120000000,
    "simulation_inv_check_depth": 100,
    "symmetry" : true,
    "typeok"  :  "TypeOKRandom",
    "tlc_specific_spec": true,
    "try_final_minimize": false,
    "simulate"  :  true,
    "actions": [
        "RequestVoteAction",
        "BecomeLeaderAction",
        "ClientRequestAction",
        "AdvanceCommitIndexAction",
        "AppendEntriesAction",
        "UpdateTermRVReqAction",
        "UpdateTermRVResAction",
        "UpdateTermAEReqAction",
        "UpdateTermAEResAction",
        "HandleRequestVoteRequestAction",
        "HandleRequestVoteResponseAction",
        "RejectAppendEntriesRequestAction",
        "AcceptAppendEntriesRequestAppendAction",
        "AcceptAppendEntriesRequestLearnCommitAction",
        "HandleAppendEntriesResponseAction"
    ],
    "tlaps_proof_config": {
        "assumes": [
            "IsFiniteSet(Server) /\\ Cardinality(Server) > 1",
            "Nil \\notin Server",
            "(Leader # Follower) /\\ (Leader # Candidate)",
            "(Follower # Candidate)",
            "Server = Server",
            "Quorum \\subseteq SUBSET Server /\\ {} \\notin Quorum /\\ Quorum # {} /\\ \\A s \\in Server : {s} \\notin Quorum",
            "MaxLogLen \\in Nat",
            "MaxTerm \\in Nat"
        ],
        "lemma_def_expands": {
            "Safety": ["H_OnePrimaryPerTerm", "H_PrimaryHasEntriesItCreated"],
            "H_RequestVoteQuorumInTermImpliesNoOtherLogsInTerm": ["ExistsRequestVoteResponseQuorum"]
        },
        "action_def_expands":{
            "HandleRequestVoteRequestAction": ["LastTerm","RequestVoteRequestType","RequestVoteResponseType","Terms","LogIndicesWithZero"],
            "HandleRequestVoteResponseAction": ["LastTerm","RequestVoteRequestType","RequestVoteResponseType","Terms","LogIndicesWithZero"],
            "RequestVoteAction": ["RequestVoteRequestType","RequestVoteResponseType","Terms","LogIndicesWithZero", "AppendEntriesRequestType","AppendEntriesResponseType"],
            "UpdateTermAction": ["RequestVoteRequestType","RequestVoteResponseType","Terms","LogIndicesWithZero", "AppendEntriesRequestType","AppendEntriesResponseType"]
        }
    }
}